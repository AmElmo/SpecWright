# Apply suggested fix with diff preview

**Issue ID**: ENG-003  
**Status**: in-review  
**Category**: fullstack  
**Complexity Score**: 5/10  
**Estimated Hours**: 4h  
**Complexity Reasoning**: Diff viewer is a common pattern, but integrating with Monaco and handling undo requires careful state management.

## Description

Add the ability to apply AI-suggested fixes with one click. Before applying, show a diff preview so developers can see exactly what will change.

## Technical Details

- Diff viewer modal using a diffing library (diff-match-patch or similar)
- Monaco editor content manipulation via API
- Undo stack with 30-second timer for reverting changes
- Track applied fixes in review record for analytics

## Dependencies

- ENG-001 (code submission) - need suggestions to have fixes
- ENG-002 (view suggestions) - need suggestion cards to add button to

## Acceptance Criteria

- [ ] "Apply Fix" button only shows when AI has suggested fix
- [ ] Diff modal shows clear before/after comparison
- [ ] Red highlighting for removed lines
- [ ] Green highlighting for added lines
- [ ] "Apply Change" updates editor content
- [ ] Suggestion card shows green checkmark after apply
- [ ] Undo button visible for 30 seconds
- [ ] Clicking undo reverts to previous code
- [ ] Multiple fixes can be applied sequentially

## Test Strategy

### Automated Tests

- Unit test: Diff generation produces correct output
- Unit test: Undo stack correctly stores/restores state
- Component test: Modal opens and closes properly

### Manual Verification (Human-in-the-Loop)

1. Find a suggestion with an available fix
2. Click "Apply Fix" and verify diff modal shows correctly
3. Apply the change and verify editor updates
4. Click undo within 30 seconds and verify code reverts

---

*Example issue - Vertical slice: complete feature, independently testable*
