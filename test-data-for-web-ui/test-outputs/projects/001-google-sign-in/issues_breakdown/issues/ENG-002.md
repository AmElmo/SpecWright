# Create database schema for users table

**Issue ID**: ENG-002  
**Status**: approved  
**Priority**: critical  
**Category**: database  
**Complexity Score**: 4/10  
**Estimated Hours**: 3h  
**Complexity Reasoning**: Requires careful schema design for OAuth user data, including nullable fields and unique constraints

> **Status Options**: `pending` (not started) | `in-review` (AI completed, needs human review) | `approved` (human verified)

## Description

Design and implement PostgreSQL database schema for storing user authentication data from Google OAuth. Include fields for Google ID, email, profile information, and timestamps using Prisma ORM.

## Technical Details

Database schema should include:
- `id`: UUID primary key
- `google_id`: Unique Google user identifier
- `email`: User email from Google
- `name`: Full name
- `picture`: Profile picture URL
- `created_at`: Account creation timestamp
- `updated_at`: Last update timestamp
- `last_login`: Last successful login

Prisma model:
```prisma
model User {
  id         String   @id @default(uuid())
  googleId   String   @unique @map("google_id")
  email      String   @unique
  name       String?
  picture    String?
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")
  lastLogin  DateTime @default(now()) @map("last_login")
  
  @@map("users")
}
```

## Dependencies

None - This can be developed in parallel with OAuth setup.

## Acceptance Criteria

- [ ] Prisma schema file created with User model
- [ ] Migration files generated
- [ ] Database migrated successfully in development
- [ ] Unique constraints on `google_id` and `email`
- [ ] Proper indexing on frequently queried fields
- [ ] Schema supports all required OAuth user data

## Test Strategy

### Automated Tests

- Migration can run without errors
- User model can be created with valid data
- Duplicate google_id or email throws proper error
- Timestamps are automatically generated

### Manual Verification (Human-in-the-Loop)

1. Run `npx prisma migrate dev` and verify success
2. Check database to confirm table structure
3. Insert test user record and verify constraints work
4. Verify indexes are created for performance

## Subtasks

1. Define Prisma User model
2. Generate migration with `prisma migrate dev`
3. Test migration on clean database
4. Verify schema in database client
5. Create seed data for development/testing

---

**Notes**: Consider future fields like `refresh_token` if implementing token refresh. Keep schema extensible for additional OAuth providers.




