# Implement OAuth callback handling in frontend

**Issue ID**: ENG-008  
**Status**: pending  
**Priority**: high  
**Category**: frontend  
**Complexity Score**: 6/10  
**Estimated Hours**: 5h  
**Complexity Reasoning**: Complex flow involving redirects, token exchange, and state management

> **Status Options**: `pending` (not started) | `in-review` (AI completed, needs human review) | `approved` (human verified)

## Description

Handle the OAuth redirect from Google, exchange the authorization code for a JWT token from your backend, store the token securely, and update the authentication state.

## Technical Details

Flow:
1. User returns from Google with auth code
2. Extract code from URL parameters
3. Send code to backend `/auth/google/callback`
4. Receive JWT token from backend
5. Store token securely
6. Update AuthContext
7. Redirect to intended destination

```typescript
const handleOAuthCallback = async () => {
  const params = new URLSearchParams(window.location.search);
  const code = params.get('code');
  const state = params.get('state');
  
  if (!code) return;
  
  try {
    const response = await fetch('/auth/google/callback', {
      method: 'POST',
      body: JSON.stringify({ code, state })
    });
    
    const { token, user } = await response.json();
    login(token, user);
    navigate('/dashboard');
  } catch (error) {
    // Handle error
  }
};
```

## Dependencies

- **ENG-007**: Sign-in button must initiate flow

## Acceptance Criteria

- [ ] Callback page handles OAuth redirect
- [ ] Authorization code extracted from URL
- [ ] Code sent to backend for token exchange
- [ ] JWT token received and stored
- [ ] Auth context updated with user data
- [ ] User redirected to appropriate page
- [ ] Error states handled gracefully
- [ ] State parameter validated for security

## Test Strategy

### Automated Tests

- Mock OAuth callback with valid code
- Test token exchange with backend
- Verify auth state updates correctly
- Test error handling for invalid code
- Verify redirect after successful login

### Manual Verification (Human-in-the-Loop)

1. Initiate OAuth flow
2. Approve Google permissions
3. Verify redirect to callback URL
4. Check token is stored
5. Verify user is logged in
6. Test redirect to original destination
7. Test error scenarios

## Subtasks

1. Create callback route/page
2. Extract code from URL params
3. Implement backend API call
4. Handle token storage
5. Update auth context
6. Implement redirect logic
7. Add error handling
8. Test complete OAuth flow

---

**Notes**: Implement proper state validation to prevent CSRF attacks. Consider showing loading spinner during token exchange.




