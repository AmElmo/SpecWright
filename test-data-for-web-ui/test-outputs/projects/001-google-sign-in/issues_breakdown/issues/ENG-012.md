# Implement rate limiting middleware

**Issue ID**: ENG-012  
**Status**: pending  
**Priority**: high  
**Category**: backend  
**Complexity Score**: 4/10  
**Estimated Hours**: 3h  
**Complexity Reasoning**: Standard rate limiting implementation with express-rate-limit

> **Status Options**: `pending` (not started) | `in-review` (AI completed, needs human review) | `approved` (human verified)

## Description

Add express-rate-limit middleware to authentication endpoints to prevent brute force attacks and abuse of OAuth flow.

## Technical Details

Implement rate limiting:
- 5 requests per 15 minutes per IP for auth endpoints
- Use Redis as store for distributed systems
- Return 429 Too Many Requests when limit exceeded
- Include retry-after header

```typescript
import rateLimit from 'express-rate-limit';
import RedisStore from 'rate-limit-redis';

const authLimiter = rateLimit({
  store: new RedisStore({
    client: redisClient,
    prefix: 'rl:auth:'
  }),
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 5, // 5 requests per window
  message: 'Too many auth attempts, please try again later',
  standardHeaders: true,
  legacyHeaders: false
});

app.use('/auth', authLimiter);
```

## Dependencies

- **ENG-004**: Auth endpoints must exist to apply rate limiting

## Acceptance Criteria

- [ ] Rate limiting applied to auth endpoints
- [ ] Redis used as store for rate limit data
- [ ] Appropriate limits configured (not too strict)
- [ ] 429 status returned when limit exceeded
- [ ] Retry-After header included
- [ ] Rate limit resets after window
- [ ] Different limits for different endpoints if needed
- [ ] Rate limit doesn't affect other endpoints

## Test Strategy

### Automated Tests

- Within limit requests succeed
- Exceeding limit returns 429
- Counter resets after window
- Redis stores rate limit data
- Retry-After header present

### Manual Verification (Human-in-the-Loop)

1. Make 5 auth requests quickly
2. Verify 6th request blocked
3. Wait 15 minutes and verify reset
4. Check Redis for rate limit keys
5. Verify error message helpful
6. Test from different IPs

## Subtasks

1. Install express-rate-limit and rate-limit-redis
2. Configure rate limiter with Redis store
3. Apply to auth endpoints
4. Set appropriate limits
5. Test rate limiting
6. Add informative error messages
7. Monitor in production

---

**Notes**: Consider different limits for different user types (authenticated vs anonymous). Monitor false positives from shared IPs.




